# synapps â€” Master Plan

**Generated by:** Forge Orchestrator v1.1.0
**Date:** 2026-02-16 06:27 UTC
**Tasks:** 38

---

## Task Board

| ID | Title | Agent | Type | Status | Dependencies |
|----|-------|-------|------|--------|-------------|
| T-040 | Design Backend Stack Upgrade Plan | claude | design | Pending | - |
| T-041 | Upgrade Backend Dependencies | codex | implement | Pending | T-040 |
| T-042 | Refactor Backend Models for Pydantic v2 | codex | implement | Pending | T-041 |
| T-043 | Upgrade SQLAlchemy ORM to 2.0 | codex | implement | Pending | T-041 |
| T-044 | Test PostgreSQL Production Support | gemini | test | Pending | T-043 |
| T-045 | Design Frontend Stack Migration Plan | claude | design | Pending | - |
| T-046 | Migrate Frontend to Vite and Tailwind | codex | implement | Pending | T-045 |
| T-047 | Integrate Zustand for State Management | codex | implement | Pending | T-046 |
| T-048 | Enable TypeScript Strict Mode | codex | implement | Pending | T-046 |
| T-049 | Update ReactFlow to v12 | codex | implement | Pending | T-046 |
| T-050 | Design Universal LLM Node and Provider Adapter | claude | design | Pending | - |
| T-051 | Implement LLM Node and Provider Adapters | codex | implement | Pending | T-050, T-042 |
| T-052 | Migrate WriterApplet to LLM Node | codex | implement | Pending | T-051 |
| T-053 | Implement Image Gen Node | codex | implement | Pending | T-042 |
| T-054 | Migrate ArtistApplet to Image Gen Node | codex | implement | Pending | T-053 |
| T-055 | Implement Memory Node with Persistent Vector Store | codex | implement | Pending | T-042 |
| T-056 | Migrate MemoryApplet to Memory Node | codex | implement | Pending | T-055 |
| T-057 | Implement HTTP Request Node | codex | implement | Pending | T-042 |
| T-058 | Implement Code Node with Sandboxing | codex | implement | Pending | T-042 |
| T-059 | Implement Transform Node | codex | implement | Pending | T-042 |
| T-060 | Implement If/Else Node for Conditional Routing | codex | implement | Pending | T-042 |
| T-061 | Implement Merge Node for Fan-in | codex | implement | Pending | T-042 |
| T-062 | Implement For-Each Node for Loop Support | codex | implement | Pending | T-042 |
| T-063 | Upgrade Execution Engine for Parallelism and Conditionals | claude | implement | Pending | T-051, T-053, T-055, T-057, T-058, T-059, T-060, T-061 |
| T-064 | Implement Node-Level Error Handling | codex | implement | Pending | T-062 |
| T-065 | Implement Execution History and Diff View | codex | implement | Pending | T-063 |
| T-066 | Implement JWT Authentication and API Key Security | codex | implement | Pending | T-042 |
| T-067 | Implement Rate Limiting and CORS Security | codex | implement | Pending | T-065 |
| T-068 | Implement Sandboxing for Code Node | codex | implement | Pending | T-058, T-065 |
| T-069 | Implement RESTful API Hardening and Versioning | codex | implement | Pending | T-042 |
| T-070 | Implement WebSocket Protocol with Auth and Recovery | codex | implement | Pending | T-065, T-067 |
| T-071 | Add ESLint, Prettier, and Ruff with Pre-commit Hooks | codex | implement | Pending | T-046, T-041 |
| T-072 | Add Backend Unit and Integration Tests | gemini | test | Pending | T-064, T-065, T-066, T-067, T-068, T-069, T-070 |
| T-073 | Add Frontend Unit, Integration, and E2E Tests | gemini | test | Pending | T-046, T-047, T-048, T-049 |
| T-074 | Implement CI/CD Pipeline with Coverage Reporting | codex | implement | Pending | T-072, T-073 |
| T-075 | Update Docker Compose and Deployment Configs | codex | implement | Pending | T-041, T-046 |
| T-076 | Review and Refactor Existing Backend Code | claude | review | Pending | T-043, T-044 |
| T-077 | Review and Refactor Existing Frontend Code | claude | review | Pending | T-046, T-047, T-048, T-049 |

---

## Task Details

### T-040: Design Backend Stack Upgrade Plan

Plan the upgrade path for backend dependencies: Python 3.11+, FastAPI 0.115+, Pydantic v2, SQLAlchemy 2.0, Alembic latest. Identify breaking changes, migration steps, and compatibility issues. Outline steps to remove deprecated patterns and v1 compat hacks.

### T-041: Upgrade Backend Dependencies

Update backend dependencies in requirements and Dockerfiles to Python 3.11+, FastAPI 0.115+, Pydantic v2, SQLAlchemy 2.0, Alembic latest. Remove deprecated @app.on_event patterns and v1 compat hacks like model_to_dict.

### T-042: Refactor Backend Models for Pydantic v2

Refactor all Pydantic models and usages to be compatible with Pydantic v2. Remove model_to_dict and related v1 compatibility code.

### T-043: Upgrade SQLAlchemy ORM to 2.0

Refactor SQLAlchemy ORM usage to new 2.0 style, including mapped_column and async patterns. Update Alembic migration scripts as needed.

### T-044: Test PostgreSQL Production Support

Test the backend with PostgreSQL as the database. Identify and fix any compatibility or migration issues. Ensure all features work with PostgreSQL.

### T-045: Design Frontend Stack Migration Plan

Plan migration from CRA to Vite, CSS modules to Tailwind 4 + shadcn/ui, and add Zustand for state management. Identify all affected files and migration steps.

### T-046: Migrate Frontend to Vite and Tailwind

Migrate frontend build tool from CRA to Vite 6. Replace CSS modules with Tailwind CSS 4 and integrate shadcn/ui. Ensure build and dev workflows work.

### T-047: Integrate Zustand for State Management

Add Zustand for global state management in the frontend. Refactor workflow, execution, and settings state to use Zustand stores.

### T-048: Enable TypeScript Strict Mode

Enable TypeScript strict mode in the frontend. Fix all resulting type errors and ensure type safety throughout the codebase.

### T-049: Update ReactFlow to v12

Upgrade ReactFlow to version 12 in the frontend. Refactor any breaking changes and ensure compatibility with TypeScript.

### T-050: Design Universal LLM Node and Provider Adapter

Design the architecture for a universal LLM Node supporting multiple providers (OpenAI, Anthropic, Google, Ollama, Custom) using an adapter pattern. Specify the common interface and provider-specific adapters.

### T-051: Implement LLM Node and Provider Adapters

Implement the universal LLM Node backend and provider adapters for OpenAI, Anthropic, Google, Ollama, and Custom endpoints. Support streaming via SSE, structured output, and all configuration options.

### T-052: Migrate WriterApplet to LLM Node

Migrate existing WriterApplet to the new LLM Node. Implement auto-migration logic to convert legacy Writer nodes to LLM Node with OpenAI/GPT-4o preset.

### T-053: Implement Image Gen Node

Implement a universal Image Gen Node supporting DALL-E 3, Stability AI, and Flux. Use provider adapter pattern similar to LLM Node.

### T-054: Migrate ArtistApplet to Image Gen Node

Migrate existing ArtistApplet to the new Image Gen Node. Implement auto-migration logic to convert legacy Artist nodes to Image Gen Node with Stability AI preset.

### T-055: Implement Memory Node with Persistent Vector Store

Implement upgraded Memory Node using ChromaDB or SQLite FTS for persistent storage. Migrate from in-memory dict to persistent backend.

### T-056: Migrate MemoryApplet to Memory Node

Migrate existing MemoryApplet to the new persistent Memory Node. Implement auto-migration logic for legacy nodes.

### T-057: Implement HTTP Request Node

Implement HTTP Request Node to make HTTP requests (GET/POST/PUT/DELETE) with configurable URL, method, headers, and body template.

### T-058: Implement Code Node with Sandboxing

Implement Code Node to execute Python or JavaScript code in a sandboxed subprocess with timeout and resource limits. Ensure no filesystem access beyond /tmp.

### T-059: Implement Transform Node

Implement Transform Node for data transformation: JSON path extract, template string, regex replace, split/join. Config-driven, no code required from user.

### T-060: Implement If/Else Node for Conditional Routing

Implement If/Else Node to evaluate a condition (contains, equals, regex, JSON path) and route to one of two output branches.

### T-061: Implement Merge Node for Fan-in

Implement Merge Node to merge multiple parallel branches with configurable merge strategy (concatenate, array, first-wins).

### T-062: Implement For-Each Node for Loop Support

Implement For-Each Node to iterate over array input, executing a sub-workflow per item with max iteration limit and parallel option.

### T-063: Upgrade Execution Engine for Parallelism and Conditionals

Upgrade the backend execution engine to support parallel node execution, fan-out, fan-in, conditional routing, and loop support. Implement topological sort and parallel group detection.

### T-064: Implement Node-Level Error Handling

Add per-node retry configuration, timeout, fallback path, structured error codes, and execution state checkpointing to the execution engine.

### T-065: Implement Execution History and Diff View

Implement storage and retrieval of full execution trace per run, including input/output, timing, errors. Add diff view between runs and re-run with modified inputs.

### T-066: Implement JWT Authentication and API Key Security

Implement JWT-based authentication with refresh tokens, email/password registration/login, and API key authentication. Encrypt API keys at rest using Fernet.

### T-067: Implement Rate Limiting and CORS Security

Add rate limiting to all endpoints (configurable per-user) and ensure CORS is properly configured per environment.

### T-068: Implement Sandboxing for Code Node

Harden the Code Node to ensure sandboxing: subprocess with resource limits, no filesystem access beyond /tmp, input sanitization.

### T-069: Implement RESTful API Hardening and Versioning

Ensure all API endpoints follow RESTful conventions, use consistent error response format, support pagination, and are versioned under /api/v1. Enable OpenAPI auto-generation.

### T-070: Implement WebSocket Protocol with Auth and Recovery

Implement structured WebSocket message format, reconnection with state recovery, and authentication on WebSocket connections.

### T-071: Add ESLint, Prettier, and Ruff with Pre-commit Hooks

Add ESLint 9 (flat config) and Prettier to the frontend, Ruff to the backend, and configure pre-commit hooks for lint, format, and type check.

### T-072: Add Backend Unit and Integration Tests

Write pytest (with pytest-asyncio) unit tests for all new applets, orchestrator engine, API endpoints, and auth flow. Add integration tests for full workflow execution. Target 80%+ coverage.

### T-073: Add Frontend Unit, Integration, and E2E Tests

Write Vitest unit tests for all components/services/state, integration tests for workflow creation/execution/settings, and Playwright E2E tests for happy path. Target 70%+ coverage.

### T-074: Implement CI/CD Pipeline with Coverage Reporting

Set up GitHub Actions for lint, type-check, test, and build on every PR. Add coverage reporting and separate deploy pipelines for staging and production.

### T-075: Update Docker Compose and Deployment Configs

Update Docker Compose for local dev (orchestrator, frontend, PostgreSQL). Update backend Dockerfile for Python 3.11. Update Vercel config for Vite build output. Add environment-based config and health check endpoint.

### T-076: Review and Refactor Existing Backend Code

Review existing backend code for compatibility with new stack, security, and maintainability. Refactor as needed to align with v1.0 standards.

### T-077: Review and Refactor Existing Frontend Code

Review existing frontend code for compatibility with new stack, accessibility, and maintainability. Refactor as needed to align with v1.0 standards.

