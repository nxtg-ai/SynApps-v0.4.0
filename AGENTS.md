# AGENTS.md (Auto-generated by Forge Orchestrator)

**Project:** synapps
**Last updated:** 2026-02-15 18:00 UTC

---

## Assigned Tasks

### T-001: Vision

Implement: Vision

### T-002: Current State (v0.5.2)

Implement: Current State (v0.5.2)

### T-003: Target State (v1.0)

Implement: Target State (v1.0)

### T-004: Competitive Positioning

Implement: Competitive Positioning

### T-005: Out of Scope (v1.x / v2.0)

Implement: Out of Scope (v1.x / v2.0)

### T-006: Success Criteria

Implement: Success Criteria

### T-007: Non-Goals

Implement: Non-Goals

### T-009: Upgrade Backend Dependencies

Update backend dependencies to Python 3.11+, FastAPI 0.115+, Pydantic v2, SQLAlchemy 2.0, and latest Alembic. Update Dockerfile and requirements.txt/pyproject.toml accordingly.

**Acceptance Criteria:**
- [ ] All backend dependencies upgraded to specified versions
- [ ] Dockerfile uses Python 3.11+ base image
- [ ] App starts without import errors

**Files you may modify:**
- `apps/orchestrator/setup.py`
- `apps/orchestrator/Dockerfile`
- `apps/orchestrator/requirements.txt`

### T-010: Refactor Backend for Pydantic v2 and SQLAlchemy 2.0

Update all backend code to use Pydantic v2 (removing v1 compat hacks like model_to_dict) and SQLAlchemy 2.0 (new ORM patterns, mapped_column). Remove deprecated FastAPI patterns.

**Acceptance Criteria:**
- [ ] No usage of Pydantic v1 compat functions
- [ ] All SQLAlchemy models use 2.0 ORM patterns
- [ ] No deprecated FastAPI event handlers
- [ ] All tests pass

**Files you may modify:**
- `apps/orchestrator/main.py`
- `apps/orchestrator/models.py`
- `apps/orchestrator/repositories.py`

### T-012: Upgrade Alembic and Enable Auto-Migration

Upgrade Alembic to latest version and configure auto-migration generation. Update migration scripts as needed.

**Acceptance Criteria:**
- [ ] Alembic upgraded and configured
- [ ] Auto-migration generation works
- [ ] Migration scripts updated for new ORM

**Files you may modify:**
- `migrations/env.py`
- `apps/orchestrator/migrations/env.py`

### T-013: Upgrade Frontend Build Tool to Vite

Migrate frontend from CRA (react-scripts) to Vite 6. Update build scripts, configuration, and ensure app runs and builds successfully.

**Acceptance Criteria:**
- [ ] CRA removed, Vite 6 configured
- [ ] Frontend builds and runs locally
- [ ] No major regressions

**Files you may modify:**
- `apps/web-frontend/package.json`
- `apps/web-frontend/vite.config.ts`
- `apps/web-frontend/tsconfig.json`

### T-014: Migrate Frontend Styling to Tailwind and shadcn/ui

Replace CSS modules with Tailwind CSS 4 and integrate shadcn/ui components. Refactor existing components to use new styling system.

**Acceptance Criteria:**
- [ ] Tailwind CSS 4 and shadcn/ui installed and configured
- [ ] All components use Tailwind classes and shadcn/ui
- [ ] No remaining CSS modules

**Files you may modify:**
- `apps/web-frontend/src/`

### T-015: Enable TypeScript Strict Mode

Enable strict mode in TypeScript config and fix resulting type errors across the frontend codebase.

**Acceptance Criteria:**
- [ ] TypeScript strict mode enabled
- [ ] No type errors in build

**Files you may modify:**
- `apps/web-frontend/tsconfig.json`
- `apps/web-frontend/src/`

### T-016: Integrate Zustand for State Management

Add Zustand to frontend and refactor state management for workflow state, execution state, and settings to use Zustand stores.

**Acceptance Criteria:**
- [ ] Zustand installed and configured
- [ ] Global state managed via Zustand
- [ ] No redundant state in React context

**Files you may modify:**
- `apps/web-frontend/src/`

### T-017: Update ReactFlow to v12

Upgrade ReactFlow to latest v12 and update usage in the workflow editor for improved performance and TypeScript support.

**Acceptance Criteria:**
- [ ] ReactFlow v12 installed
- [ ] All usages updated to v12 API
- [ ] No runtime errors

**Files you may modify:**
- `apps/web-frontend/package.json`
- `apps/web-frontend/src/`

### T-018: Implement Design Tokens and Dark Mode

Define and implement design tokens for colors, spacing, and typography. Set dark mode as default with toggle support.

**Acceptance Criteria:**
- [ ] Design tokens defined and used throughout styles
- [ ] Dark mode is default, toggle works
- [ ] All components visually consistent

**Files you may modify:**
- `apps/web-frontend/src/`

### T-020: Implement Node Card Redesign and Validation

Update node cards to have category-colored borders, status indicators, mini-previews, port type hints, and connection validation logic.

**Acceptance Criteria:**
- [ ] Node cards styled as specified
- [ ] Status indicators and mini-previews work
- [ ] Invalid connections prevented

**Files you may modify:**
- `apps/web-frontend/src/`

### T-021: Implement Execution Visualization Features

Add animated edge flow, node glow effects, per-node progress indicators, and execution timeline bar to visualize workflow execution in real-time.

**Acceptance Criteria:**
- [ ] Animated edge flow during execution
- [ ] Node glow and progress indicators
- [ ] Timeline bar shows total progress

**Files you may modify:**
- `apps/web-frontend/src/`

### T-022: Implement Dashboard and New Pages

Create dashboard with workflow cards, quick-run, search/filter, usage stats. Add settings page (API keys, theme, model selection) and applet library page.

**Acceptance Criteria:**
- [ ] Dashboard, settings, and applet library pages implemented
- [ ] All features functional and responsive

**Files you may modify:**
- `apps/web-frontend/src/`

### T-024: Implement Execution Engine Upgrades

Refactor orchestrator to support parallel execution, fan-in/fan-out, conditional and loop nodes, error handling (retries, timeouts, fallback), and full execution history.

**Acceptance Criteria:**
- [ ] Parallel and conditional execution supported
- [ ] Loop and merge nodes work as specified
- [ ] Per-node error handling and fallback implemented
- [ ] Execution history with trace and diff view

**Files you may modify:**
- `apps/orchestrator/main.py`
- `apps/orchestrator/models.py`

### T-025: Implement FM-Agnostic LLM Node and Provider Adapters

Replace WriterApplet with a universal LLM Node supporting OpenAI, Anthropic, Google, Ollama, and custom endpoints. Implement provider adapter pattern, node config UI, and streaming via SSE.

**Acceptance Criteria:**
- [ ] LLM Node supports all listed providers
- [ ] Provider adapters implement common interface
- [ ] Streaming output works in frontend
- [ ] No hardcoded provider logic outside adapter layer

**Files you may modify:**
- `apps/applets/writer/applet.py`
- `apps/web-frontend/src/`

### T-026: Implement Core Applets: Image Gen, Memory, HTTP, Code, Transform, If/Else, Merge

Implement new universal applets: Image Gen Node, upgraded Memory Node (persistent vector store), HTTP Request Node, Code Node (sandboxed), Transform Node, If/Else Node, Merge Node.

**Acceptance Criteria:**
- [ ] All core applets implemented and registered
- [ ] Each applet passes unit tests
- [ ] Code Node uses sandboxed subprocess with resource limits

**Files you may modify:**
- `apps/applets/image_gen/applet.py`
- `apps/applets/memory/applet.py`
- `apps/applets/http_request/applet.py`
- `apps/applets/code/applet.py`
- `apps/applets/transform/applet.py`
- `apps/applets/if_else/applet.py`
- `apps/applets/merge/applet.py`

### T-027: Migrate Legacy Applets to New Nodes

Implement migration logic to auto-convert WriterApplet, ArtistApplet, and MemoryApplet to the new LLM Node, Image Gen Node, and upgraded Memory Node, preserving user data.

**Acceptance Criteria:**
- [ ] Legacy applets auto-migrate on load
- [ ] No user data lost
- [ ] Migration is idempotent

**Files you may modify:**
- `apps/applets/writer/applet.py`
- `apps/applets/artist/applet.py`
- `apps/applets/memory/applet.py`

### T-028: Implement JWT Auth and API Key Security

Add JWT-based authentication with refresh tokens, email/password registration and login, API key authentication, and encrypted storage of API keys.

**Acceptance Criteria:**
- [ ] JWT auth flow implemented
- [ ] API keys encrypted at rest
- [ ] API key endpoints secured

**Files you may modify:**
- `apps/orchestrator/main.py`
- `apps/orchestrator/models.py`

### T-029: Implement Security Features and Rate Limiting

Add CORS configuration, rate limiting per user, input sanitization, HTTPS enforcement in production, and sandboxing for Code Node.

**Acceptance Criteria:**
- [ ] CORS configured per environment
- [ ] Rate limiting enforced on all endpoints
- [ ] Inputs sanitized
- [ ] HTTPS enforced in prod
- [ ] Code Node sandboxed

**Files you may modify:**
- `apps/orchestrator/main.py`
- `apps/orchestrator/middleware/billing_guard.py`

### T-030: Add ESLint, Prettier, Ruff, and Pre-commit Hooks

Integrate ESLint 9 (flat config), Prettier, Ruff for Python, and pre-commit hooks for linting, formatting, and type checking.

**Acceptance Criteria:**
- [ ] ESLint 9 and Prettier configured for frontend
- [ ] Ruff configured for backend
- [ ] Pre-commit hooks run lint, format, type check

**Files you may modify:**
- `apps/web-frontend/.eslintrc`
- `apps/web-frontend/.prettierrc`
- `apps/orchestrator/pyproject.toml`
- `.pre-commit-config.yaml`

### T-033: Implement CI/CD Pipeline with Coverage Reporting

Set up GitHub Actions for lint, type-check, test, build on PRs. Add coverage reporting and separate deploy pipelines for staging and production.

**Acceptance Criteria:**
- [ ] CI runs lint, type-check, test, build on PRs
- [ ] Coverage reports uploaded
- [ ] Staging and production deploys separated

**Files you may modify:**
- `.github/workflows/`

### T-035: Optimize Backend and Frontend Performance

Implement backend async everywhere, connection pooling, lazy applet loading. On frontend, add code splitting, tree-shaking, and ReactFlow virtualization.

**Acceptance Criteria:**
- [ ] Backend async and connection pooling enabled
- [ ] Lazy applet loading works
- [ ] Frontend code splitting and tree-shaking in place
- [ ] ReactFlow virtualization for large workflows

**Files you may modify:**
- `apps/orchestrator/main.py`
- `apps/web-frontend/src/`

### T-036: Optimize Database Indexes and Queries

Add indexes on frequently queried columns and optimize queries for flow history and run status.

**Acceptance Criteria:**
- [ ] Indexes created on flow_id, status, created_at
- [ ] History queries optimized
- [ ] No slow query warnings

**Files you may modify:**
- `apps/orchestrator/models.py`

### T-037: Implement Docker Compose and Health Check Endpoint

Create Docker Compose setup for orchestrator, frontend, and PostgreSQL. Add /health endpoint returning status, version, and uptime.

**Acceptance Criteria:**
- [ ] docker-compose up starts all services
- [ ] /health endpoint returns correct JSON

**Files you may modify:**
- `docker-compose.yml`
- `apps/orchestrator/main.py`

## Rules

- Complete tasks one at a time
- Do NOT modify files outside your assigned task scope
- Run tests before marking a task complete
- Check `.forge/state.json` for current orchestration state
